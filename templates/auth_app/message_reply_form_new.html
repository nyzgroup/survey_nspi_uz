{% extends 'auth_app/base.html' %}
{% block title %}Javob yozish{% endblock %}
{% block content %}
<div class="message-reply-page">
  <div class="container-fluid px-3 px-md-4">
    <div class="row justify-content-center">
      <div class="col-12 col-md-8 col-lg-6">
        <!-- Header Section -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h3 mb-0 text-dark">Javob yozish</h2>
          <a href="javascript:history.back()" class="btn btn-outline-secondary btn-sm">
            <i class="fas fa-arrow-left me-2"></i>Orqaga
          </a>
        </div>

        <!-- Reply Form Card -->
        <div class="card shadow-sm">
          <div class="card-header bg-success text-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-reply me-2"></i>Admin javobi
            </h5>
          </div>
          <div class="card-body">
            <form method="post" class="needs-validation" novalidate>
              {% csrf_token %}
              
              <!-- Content Field -->
              <div class="mb-4">
                <label for="{{ form.content.id_for_label }}" class="form-label fw-bold">
                  <i class="fas fa-comment-alt me-2 text-muted"></i>{{ form.content.label }}
                </label>
                <textarea class="form-control {% if form.content.errors %}is-invalid{% endif %}" 
                          id="{{ form.content.id_for_label }}" 
                          name="{{ form.content.name }}" 
                          rows="8" 
                          placeholder="Murojaatga javobingizni yozing..."
                          required>{{ form.content.value|default:'' }}</textarea>
                {% if form.content.errors %}
                  <div class="invalid-feedback">
                    {{ form.content.errors.0 }}
                  </div>
                {% endif %}
                <div class="form-text">
                  <i class="fas fa-info-circle me-1"></i>
                  To'liq va tushunarli javob bering
                </div>
              </div>

              <!-- Character Counter -->
              <div class="mb-3">
                <small class="text-muted">
                  <span id="char-count">0</span> belgi yozildi
                </small>
              </div>

              <!-- Form Actions -->
              <div class="d-flex flex-column flex-md-row gap-3 mt-4">
                <button type="submit" class="btn btn-success btn-lg flex-fill">
                  <i class="fas fa-paper-plane me-2"></i>Javobni yuborish
                </button>
                <a href="javascript:history.back()" class="btn btn-outline-secondary btn-lg flex-fill">
                  <i class="fas fa-times me-2"></i>Bekor qilish
                </a>
              </div>
            </form>
          </div>
        </div>

        <!-- Guidelines Card -->
        <div class="card mt-4 bg-light">
          <div class="card-body">
            <h6 class="card-title">
              <i class="fas fa-lightbulb text-warning me-2"></i>Javob yozishda e'tibor bering:
            </h6>
            <ul class="list-unstyled mb-0 small">
              <li class="mb-2">
                <i class="fas fa-check text-success me-2"></i>
                Hurmatli va professional uslubda yozing
              </li>
              <li class="mb-2">
                <i class="fas fa-check text-success me-2"></i>
                Aniq va tushunarli javob bering
              </li>
              <li class="mb-2">
                <i class="fas fa-check text-success me-2"></i>
                Agar kerak bo'lsa, qo'shimcha ko'rsatmalar bering
              </li>
              <li>
                <i class="fas fa-check text-success me-2"></i>
                Tez orada javob berishga harakat qiling
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Custom Styles -->
<style>
.message-reply-page .form-control:focus {
  border-color: #198754;
  box-shadow: 0 0 0 0.2rem rgba(25, 135, 84, 0.25);
}

.message-reply-page .was-validated .form-control:valid {
  border-color: #198754;
}

.message-reply-page textarea {
  resize: vertical;
  min-height: 200px;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .message-reply-page .card-body {
    padding: 1.5rem 1rem;
  }
  
  .message-reply-page .btn-lg {
    padding: 0.75rem 1rem;
    font-size: 1rem;
  }
  
  .message-reply-page textarea {
    min-height: 150px;
  }
}

@media (max-width: 576px) {
  .message-reply-page .container-fluid {
    padding: 0.5rem;
  }
  
  .message-reply-page .d-flex.justify-content-between {
    flex-direction: column;
    align-items: flex-start !important;
    gap: 1rem;
  }
  
  .message-reply-page .btn-lg {
    padding: 0.75rem;
    font-size: 0.95rem;
  }
}
</style>

<!-- JavaScript for Form Enhancement -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Character counter
  const textarea = document.querySelector('textarea[name="content"]');
  const charCount = document.getElementById('char-count');
  
  if (textarea && charCount) {
    function updateCharCount() {
      const count = textarea.value.length;
      charCount.textContent = count;
      
      // Color coding based on length
      if (count < 50) {
        charCount.className = 'text-warning';
      } else if (count < 500) {
        charCount.className = 'text-success';
      } else {
        charCount.className = 'text-primary';
      }
    }
    
    // Initial count
    updateCharCount();
    
    // Update on input
    textarea.addEventListener('input', updateCharCount);
  }

  // Form validation
  const form = document.querySelector('.needs-validation');
  if (form) {
    form.addEventListener('submit', function(event) {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.classList.add('was-validated');
    }, false);
  }

  // Auto-resize textarea
  if (textarea) {
    function autoResize() {
      textarea.style.height = 'auto';
      textarea.style.height = textarea.scrollHeight + 'px';
    }
    
    textarea.addEventListener('input', autoResize);
    autoResize(); // Initial resize
  }
});
</script>
{% endblock %}
