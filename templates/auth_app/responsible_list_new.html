{% extends 'auth_app/base.html' %}
{% block title %}Mas'ul shaxslar{% endblock %}
{% block content %}
<div class="responsible-list-page">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h3 mb-0 text-dark">Mas'ul shaxslar</h2>
    <div class="d-flex align-items-center">
      <span class="badge bg-light text-dark border me-3">
        <i class="fas fa-users me-1"></i>{{ responsibles|length }} ta mas'ul
      </span>
    </div>
  </div>

  {% if responsibles %}
    <!-- Responsible Persons Grid -->
    <div class="row g-4">
      {% for person in responsibles %}
      <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
        <div class="card responsible-card h-100 shadow-sm">
          <div class="card-body text-center p-4">
            <!-- Profile Image -->
            <div class="profile-image-container mb-3">
              {% if person.image_url %}
                <img src="{{ person.image_url }}" 
                     class="rounded-circle profile-image" 
                     alt="{{ person.full_name }}"
                     loading="lazy">
              {% else %}
                <div class="profile-placeholder rounded-circle d-flex align-items-center justify-content-center bg-primary text-white">
                  <i class="fas fa-user fa-2x"></i>
                </div>
              {% endif %}
            </div>

            <!-- Name and Position -->
            <h5 class="card-title text-primary mb-2 fw-bold">{{ person.full_name }}</h5>
            <p class="text-muted mb-3 fw-medium">{{ person.position }}</p>

            <!-- Contact Information -->
            <div class="contact-info">
              {% if person.phone_number %}
                <div class="contact-item mb-2">
                  <i class="fas fa-phone text-success me-2"></i>
                  <a href="tel:{{ person.phone_number }}" class="text-decoration-none text-dark">
                    {{ person.phone_number }}
                  </a>
                </div>
              {% endif %}

              {% if person.email %}
                <div class="contact-item mb-2">
                  <i class="fas fa-envelope text-info me-2"></i>
                  <a href="mailto:{{ person.email }}" class="text-decoration-none text-dark">
                    {{ person.email }}
                  </a>
                </div>
              {% endif %}

              {% if person.telegram_username %}
                <div class="contact-item mb-2">
                  <i class="fab fa-telegram text-primary me-2"></i>
                  <a href="https://t.me/{{ person.telegram_username }}" 
                     target="_blank" 
                     class="text-decoration-none text-dark">
                    @{{ person.telegram_username }}
                  </a>
                </div>
              {% endif %}

              {% if person.office_location %}
                <div class="contact-item mb-2">
                  <i class="fas fa-map-marker-alt text-danger me-2"></i>
                  <span class="text-dark">{{ person.office_location }}</span>
                </div>
              {% endif %}
            </div>

            <!-- Responsibilities -->
            {% if person.responsibilities_short %}
              <div class="responsibilities mt-3 pt-3 border-top">
                <h6 class="text-secondary mb-2">
                  <i class="fas fa-tasks me-1"></i>Mas'uliyat sohalari:
                </h6>
                <p class="small text-muted mb-0">{{ person.responsibilities_short }}</p>
              </div>
            {% endif %}

            <!-- Action Buttons -->
            <div class="action-buttons mt-3 pt-3 border-top">
              <div class="d-flex gap-2 justify-content-center">
                {% if person.phone_number %}
                  <a href="tel:{{ person.phone_number }}" 
                     class="btn btn-sm btn-outline-success flex-fill">
                    <i class="fas fa-phone me-1"></i>Qo'ng'iroq
                  </a>
                {% endif %}
                
                <a href="{% url 'message_create' %}?responsible={{ person.id }}" 
                   class="btn btn-sm btn-primary flex-fill">
                  <i class="fas fa-envelope me-1"></i>Murojaat
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <!-- Empty State -->
    <div class="text-center py-5">
      <div class="empty-state">
        <i class="fas fa-users text-muted mb-3" style="font-size: 4rem;"></i>
        <h5 class="text-muted mb-3">Mas'ul shaxslar topilmadi</h5>
        <p class="text-muted mb-4">Hozircha tizimda mas'ul shaxslar ro'yxati yo'q</p>
      </div>
    </div>
  {% endif %}
</div>

<!-- Custom Styles -->
<style>
.responsible-list-page .responsible-card {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  border: 1px solid rgba(0,0,0,0.1);
}

.responsible-list-page .responsible-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.responsible-list-page .profile-image-container {
  position: relative;
}

.responsible-list-page .profile-image,
.responsible-list-page .profile-placeholder {
  width: 100px;
  height: 100px;
  object-fit: cover;
  border: 3px solid #e9ecef;
}

.responsible-list-page .profile-placeholder {
  margin: 0 auto;
}

.responsible-list-page .contact-item {
  font-size: 0.9rem;
  line-height: 1.5;
}

.responsible-list-page .contact-item a:hover {
  color: var(--bs-primary) !important;
}

.responsible-list-page .action-buttons .btn {
  font-size: 0.8rem;
  padding: 0.4rem 0.8rem;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .responsible-list-page .profile-image,
  .responsible-list-page .profile-placeholder {
    width: 80px;
    height: 80px;
  }
  
  .responsible-list-page .card-body {
    padding: 1.5rem 1rem;
  }
  
  .responsible-list-page .contact-item {
    font-size: 0.85rem;
  }
  
  .responsible-list-page .action-buttons .btn {
    font-size: 0.75rem;
    padding: 0.3rem 0.6rem;
  }
}

@media (max-width: 576px) {
  .responsible-list-page .d-flex.justify-content-between {
    flex-direction: column;
    align-items: flex-start !important;
    gap: 1rem;
  }
  
  .responsible-list-page .profile-image,
  .responsible-list-page .profile-placeholder {
    width: 70px;
    height: 70px;
  }
  
  .responsible-list-page .card-title {
    font-size: 1.1rem;
  }
  
  .responsible-list-page .action-buttons .d-flex {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .responsible-list-page .action-buttons .btn {
    width: 100%;
  }
}

/* Print Styles */
@media print {
  .responsible-list-page .action-buttons {
    display: none;
  }
  
  .responsible-list-page .responsible-card {
    break-inside: avoid;
    border: 1px solid #000;
  }
}
</style>
{% endblock %}
