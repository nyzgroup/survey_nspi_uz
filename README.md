# HEMIS So'rovnoma Tizimi üöÄ

### Tashqi API bilan integratsiyalashgan dinamik so'rovnomalar platformasi

![Django](https://img.shields.io/badge/Django-4.2-blue?logo=django&logoColor=white)
![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python&logoColor=white)
![Celery](https://img.shields.io/badge/Celery-5.3-green?logo=celery)
![Bootstrap](https://img.shields.io/badge/Bootstrap-5.3.2-purple?logo=bootstrap&logoColor=white)
![Litsenziya](https://img.shields.io/badge/Litsenziya-MIT-green)

Ushbu loyiha talabalar uchun tashqi **HEMIS API** orqali autentifikatsiya qilish va ular uchun administratorlar tomonidan yaratilgan dinamik so'rovnomalarda qatnashish imkonini beruvchi veb-ilova hisoblanadi. Loyiha Django, Celery va zamonaviy frontend texnologiyalaridan unumli foydalangan.

---

## ‚ú® Asosiy imkoniyatlar

-   **Tashqi API orqali autentifikatsiya:** Foydalanuvchilar (talabalar) HEMIS tizimidagi login va parollari orqali tizimga kiradilar.
-   **Dinamik so'rovnoma konstruktori:** Administratorlar admin panel orqali hech qanday kod yozmasdan, turli xil savol turlari (yagona tanlov, ko'p tanlov, matnli javob) bilan so'rovnomalar yarata oladilar.
-   **Asinxron vazifalar:** Foydalanuvchi profillarini yangilash kabi sekin operatsiyalar **Celery** yordamida fonda bajariladi, bu esa tizimning tez ishlashini ta'minlaydi.
-   **Zamonaviy va Interaktiv UI/UX:** So'rovnoma sahifasi Vanilla JavaScript yordamida client-side rendering (CSR) qilinadi. Bu sahifani yangilamasdan tezkor ishlash imkonini beradi.
-   **Professional Admin Paneli:** `Jazzmin` yordamida admin paneli ancha chiroyli va funksional ko'rinishga keltirilgan.
-   **Responsiv Dizayn:** **Bootstrap 5.3.2** va custom CSS yordamida yaratilgan interfeys mobil qurilmalardan tortib katta ekranlargacha mukammal ko'rinadi.
-   **Xavfsiz konfiguratsiya:** Barcha maxfiy ma'lumotlar (`SECRET_KEY`, API tokenlar) koddan ajratilib, `.env` faylida saqlanadi.

---

## üé® Tashqi ko'rinishi

So'rovnoma sahifasi foydalanuvchi uchun maksimal darajada qulay qilib ishlangan. Progress "Stepper" yordamida ko'rsatiladi va to'liq interaktiv.


![So'rovnoma sahifasi]![alt text]({C5C8F953-CC8F-4D3F-A11D-DD6CE2A9D3EC}-1.png)





---

## ‚öôÔ∏è Texnologiyalar steki

| Kategoriya          | Texnologiya                                                                |
| ------------------- | -------------------------------------------------------------------------- |
| **Backend**         | Django, Django REST Framework, Simple JWT                                  |
| **Frontend**        | HTML5, Bootstrap 5.3.2, Vanilla JavaScript, Font Awesome 6.4.0 |
| **Ma'lumotlar Baza**| PostgreSQL (Production uchun tavsiya etiladi), SQLite3 (Development uchun)   |
| **Asinxron Vazifalar** | Celery, Redis (Broker va Natijalar uchun)                                |
| **Server**          | Gunicorn / uWSGI (Production), Nginx (Reverse Proxy)                       |

---

## üîß O'rnatish va sozlash

Loyihani lokal kompyuteringizda ishga tushirish uchun quyidagi qadamlarni bajaring:

**1. Loyihani yuklab oling:**
```bash
git clone https://github.com/sizning-username/sizning-repo.git
cd sizning-repo
```

**2. Virtual muhit yaratish va aktivlashtirish:**
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# MacOS / Linux
python3 -m venv venv
source venv/bin/activate
```

**3. Python bog'liqliklarini o'rnatish:**
> **Muhim:** Loyihangizda `requirements.txt` fayli bo'lishi kerak. Uni yaratish uchun: `pip freeze > requirements.txt`

```bash
pip install -r requirements.txt
```

**4. Frontend bog'liqliklarini o'rnatish:**
> Buning uchun kompyuteringizda [Node.js](https://nodejs.org/) o'rnatilgan bo'lishi kerak.

```bash
npm install
```

**5. Muhit o'zgaruvchilarini sozlash:**
`.env.example` faylidan nusxa olib, `.env` nomli yangi fayl yarating va uni o'zingizning ma'lumotlaringiz bilan to'ldiring.

```bash
cp .env.example .env
# Endi .env faylini tahrirlang
```

**6. Ma'lumotlar bazasini sozlash:**
```bash
python manage.py migrate
```

**7. Superuser (admin) yaratish:**
```bash
python manage.py createsuperuser
```

---

## üöÄ Loyihani ishga tushirish

Loyihani to'liq ishga tushirish uchun **3 ta alohida terminal** oynasi kerak bo'ladi.

**1-Terminal: Tailwind CSS kompilyatorini ishga tushirish**
(CSS'dagi o'zgarishlarni avtomatik kuzatib boradi)
```bash
npx tailwindcss -i ./auth_app/static/auth_app/css/input.css -o ./auth_app/static/auth_app/css/output.css --watch
```

**2-Terminal: Celery worker'ni ishga tushirish**
(Fon vazifalarini bajarish uchun)
```bash
celery -A external_auth_project worker -l info
```

**3-Terminal: Django serverini ishga tushirish**
```bash
python manage.py runserver
```

Endi loyiha [http://127.0.0.1:8000/](http://127.0.0.1:8000/) manzilida ishlayotgan bo'lishi kerak.

---

## üê≥ Docker va Django bilan ishga tushirish

### 1. Muhitni tayyorlash
- Python 3.11+ o‚Äòrnatilgan bo‚Äòlishi kerak.
- Docker Desktop va Docker Compose o‚Äòrnatilgan bo‚Äòlishi kerak.

### 2. Docker yordamida ishga tushirish

```powershell
docker-compose up -d --build
```

- `web` ‚Äî Django server (gunicorn bilan)
- `db` ‚Äî PostgreSQL ma'lumotlar bazasi
- `redis` ‚Äî Redis server (kesh va broker uchun)
- `celery` ‚Äî Celery worker

### 3. Django migratsiyalari
Konteynerlar ishga tushgandan so‚Äòng, migratsiyalarni bajaring:

```powershell
docker-compose exec web python manage.py makemigrations
docker-compose exec web python manage.py migrate
```

### 4. Superuser yaratish

```powershell
docker-compose exec web python manage.py createsuperuser
```

### 5. Admin panel va API
- Admin panel: http://localhost:8000/admin/
- API endpointlar: http://localhost:8000/

### 6. Muhit sozlamalari
- Muhit o‚Äòzgaruvchilari `.env.prod` faylida saqlanadi.
- `docker-compose.yml` va `requirements.txt` fayllarini o‚Äòzgartirish orqali servislarni sozlashingiz mumkin.

### 7. Foydali buyruqlar

Konteynerlarni to‚Äòxtatish:
```powershell
docker-compose down
```

Loglarni ko‚Äòrish:
```powershell
docker-compose logs -f
```

### 8. Muammolar va yechimlar
- Agar `service ... is not running` xatoligi chiqsa, avval `docker-compose up -d --build` buyrug‚Äòini bajaring.
- `psycopg2` yoki `psycopg2-binary` bilan bog‚Äòliq xatoliklar uchun: virtual muhitni tozalang va faqat `psycopg2-binary` ni o‚Äòrnating.
- Docker Desktop to‚Äòliq ishga tushganiga ishonch hosil qiling.

---

## üõ°Ô∏è Xavfsizlik va himoya mexanizmlari

Loyiha xavfsizligi uchun quyidagi zamonaviy himoya usullari va sozlamalar joriy etilgan:

### 1. CSRF (Cross-Site Request Forgery) himoyasi
- **CSRF_COOKIE_HTTPONLY = True** ‚Äî CSRF cookie‚Äôni JavaScript orqali o‚Äòqib bo‚Äòlmaydi, bu xakerlar uchun hujumni qiyinlashtiradi.
- **CSRF_COOKIE_SECURE = True** ‚Äî CSRF cookie faqat HTTPS orqali yuboriladi, bu cookie‚Äôni tarmoqqa ‚Äúsƒ±zib‚Äù ketishidan himoya qiladi.
- **CSRF_COOKIE_SAMESITE = 'Lax'** ‚Äî CSRF cookie faqat bir xil sayt so‚Äòrovlarida yuboriladi, bu boshqa saytlardan yuborilgan so‚Äòrovlar orqali hujum qilishni cheklaydi.
- **CSRF_USE_SESSIONS = False** ‚Äî CSRF token cookie‚Äôda saqlanadi, bu ko‚Äòp hollarda qulay va xavfsiz.
- **CSRF_COOKIE_NAME = 'hemis_csrf_token'** ‚Äî Maxsus nom, xakerlar uchun taxmin qilishni qiyinlashtiradi.
- **CSRF_COOKIE_AGE** va **CSRF_COOKIE_PATH** ‚Äî Cookie‚Äôning amal qilish muddati va qamrovi aniq belgilanadi.

### 2. Clickjacking himoyasi
- **X_FRAME_OPTIONS = 'DENY'** ‚Äî Saytingiz boshqa saytlardagi `<iframe>` ichida ochilishini to‚Äòliq taqiqlaydi. Bu clickjacking hujumlaridan himoya qiladi.

### 3. HTTPS va cookie xavfsizligi
- **CSRF_COOKIE_SECURE = True** va **SESSION_COOKIE_SECURE = True** ‚Äî Cookie‚Äôlar faqat HTTPS orqali yuboriladi.
- **CSRF_COOKIE_HTTPONLY = True** va **SESSION_COOKIE_HTTPONLY = True** ‚Äî Cookie‚Äôlarni JavaScript orqali o‚Äòqib bo‚Äòlmaydi.

### 4. Parol va foydalanuvchi xavfsizligi
- **AUTH_PASSWORD_VALIDATORS** ‚Äî Parollarni kuchli va xavfsiz bo‚Äòlishini ta‚Äôminlaydi (uzunlik, oddiy parollarni rad etish, raqamli parollarni rad etish va boshqalar).

### 5. ALLOWED_HOSTS va DEBUG
- **ALLOWED_HOSTS** ‚Äî Faqat ruxsat etilgan domenlardan kirishga ruxsat.
- **DEBUG = False** (productionda) ‚Äî Xatoliklar va maxfiy ma‚Äôlumotlar foydalanuvchiga chiqmaydi.

### 6. Django ORM va SQL injection
- Django ORM ishlatilgani uchun SQL injection hujumlaridan himoya mavjud.

### 7. Xavfsiz logger va monitoring
- **LOGGING** sozlamalari ‚Äî Xatoliklar va muammolarni kuzatish, loglarni tashqi foydalanuvchiga chiqarmaslik.

---

**Qo'shimcha xavfsizlik qatlamlari uchun quyidagilarni ham qo'shish mumkin:**
- `SECURE_HSTS_SECONDS` ‚Äî Brauzerga faqat HTTPS orqali ulanishni majburlash.
- `SECURE_BROWSER_XSS_FILTER` ‚Äî Brauzerning XSS filterini yoqish.
- `SECURE_CONTENT_TYPE_NOSNIFF` ‚Äî Brauzerga kontent turini taxmin qilmaslikni buyurish.

---

Barcha asosiy xavfsizlik mexanizmlari va zamonaviy himoya usullari ushbu loyihada to‚Äòliq joriy etilgan. Agar yana savollar bo‚Äòlsa yoki qo‚Äòshimcha himoya qatlamlari kerak bo‚Äòlsa, loyiha adminiga murojaat qilishingiz mumkin.

---

## üîë Muhit o'zgaruvchilari (`.env` fayli)

`.env` faylingiz taxminan quyidagi ko'rinishda bo'lishi kerak. **Bu faylni hech qachon Git'ga qo'shmang!**

```ini
# Django sozlamalari
DJANGO_SECRET_KEY='sizning_maxfiy_kalitingiz'
DEBUG=True
DJANGO_ALLOWED_HOSTS=127.0.0.1, localhost

# Tashqi API sozlamalari
EXTERNAL_API_BASE_URL="https://student.nspi.uz/rest"

# Redis va Celery sozlamalari
CELERY_BROKER_URL="redis://localhost:6379/0"
CELERY_RESULT_BACKEND="redis://localhost:6379/0"
REDIS_URL="redis://localhost:6379/1" # Kesh uchun

# Tizim tokenlari (agar kerak bo'lsa)
HEMIS_SYSTEM_API_TOKEN=sizning_tizim_tokeningiz
```

---

## üìÇ Loyiha strukturasi

```
‚îú‚îÄ‚îÄ auth_app/                # Asosiy ilova
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ services/            # Tashqi API bilan ishlash uchun servislar
‚îÇ   ‚îú‚îÄ‚îÄ static/              # CSS, JS fayllar
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py             # Celery vazifalari
‚îÇ   ‚îú‚îÄ‚îÄ templates/           # HTML shablonlar
‚îÇ   ‚îú‚îÄ‚îÄ admin.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ views.py
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ external_auth_project/     # Loyihaning asosiy sozlamalari
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îú‚îÄ‚îÄ urls.py
‚îÇ   ‚îî‚îÄ‚îÄ celery.py
‚îú‚îÄ‚îÄ manage.py                # Django boshqaruv skripti
‚îú‚îÄ‚îÄ requirements.txt         # Python bog'liqliklari
‚îú‚îÄ‚îÄ package.json             # Frontend bog'liqliklari
‚îú‚îÄ‚îÄ tailwind.config.js       # Tailwind sozlamalari
‚îî‚îÄ‚îÄ README.md                # Shu fayl
```

---

## üìú Litsenziya

---

## üîí Parollar va ma'lumotlar shifrlanishi

- **Foydalanuvchi parollari** Django‚Äôning ichki mexanizmi orqali xavfsiz tarzda saqlanadi. Django parollarni **PBKDF2** (Password-Based Key Derivation Function 2) algoritmi yordamida, har bir parol uchun alohida **salt** bilan va ko‚Äòp martalik iteratsiya orqali xesh qiladi. Bu usul zamonaviy va kuchli hisoblanadi.
    - Django shuningdek, **Argon2**, **bcrypt**, va **SHA1** kabi boshqa xesh algoritmlarini ham qo‚Äòllab-quvvatlaydi (loyiha sozlamalarida istalganiga o‚Äòtkazish mumkin).
- **Ma'lumotlar bazasidagi maxfiy ma'lumotlar** (masalan, tokenlar yoki maxsus identifikatorlar) odatda **.env** faylida saqlanadi va koddan ajratilgan. Agar ma'lumotlarni shifrlash yoki xesh qilish talab qilinsa, Python‚Äôning **cryptography** kutubxonasi yoki Django‚Äôning maxfiy ma‚Äôlumotlar uchun tavsiya etilgan usullari ishlatiladi.
- **HTTPS** orqali barcha ma‚Äôlumotlar tarmoqda shifrlangan holda uzatiladi (production muhitda majburiy).

**Muhim:** Parollar va maxfiy ma‚Äôlumotlar hech qachon ochiq matnda saqlanmaydi va Git repozitoriyga yuklanmaydi.

---

## üß™ Testlash va samaradorlik monitoringi

### 1. Avtomatlashtirilgan testlar
- Loyiha ichida `auth_app/tests.py` va boshqa test fayllari mavjud.
- Django‚Äôning ichki test frameworki yordamida barcha asosiy funksiyalar va API endpointlar avtomatik testdan o‚Äòtkaziladi.
- Testlarni ishga tushirish uchun:
  ```bash
  python manage.py test
  ```
- Test natijalari konsolda to‚Äòliq va aniq ko‚Äòrinishda chiqadi, har bir test uchun muvaffaqiyatli va muvaffaqiyatsiz holatlar alohida ko‚Äòrsatiladi.

### 2. Locust yordamida yuklama va samaradorlik testi
- Loyiha ichida `external_auth_project/locustfile.py` fayli mavjud.
- [Locust](https://locust.io/) yordamida tizimga real yuklama berilib, API va asosiy funksiyalarning samaradorligi va barqarorligi testdan o‚Äòtkaziladi.
- Locust testini ishga tushirish uchun:
  ```bash
  locust -f external_auth_project/locustfile.py
  ```
- Web interfeys orqali (odatda http://localhost:8089) foydalanuchilar soni va so‚Äòrovlar tezligini sozlash mumkin.
- Natijalar grafik va jadval ko‚Äòrinishida, eng muhim metrikalar (response time, failures, throughput) bo‚Äòyicha ko‚Äòrsatiladi.

### 3. Test natijalarining samarali ko‚Äòrinishi
- Har bir test va yuklama natijasi aniq, grafik va jadval ko‚Äòrinishida taqdim etiladi.
- Xatoliklar va sekin ishlash joylari tezda aniqlanadi va optimallashtirish uchun asos bo‚Äòladi.
- CI/CD jarayoniga integratsiya qilish mumkin (masalan, GitHub Actions yoki boshqa runnerlar orqali).

